<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
    /* === Base Styles === */
    body {
      margin: 0;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    /* === "Frosted Glass" Control Panel Styles === */
    .controls {
      position: absolute;
      bottom: 25px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      display: flex;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50px;
      padding: 10px;
      align-items: center;
      transition: background 0.3s ease;
    }

    .controls button {
      background: none;
      border: none;
      padding: 0;
      margin: 0 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      outline: none;
      position: relative;
    }

    .color-circle {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 3px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    .controls button:not(#btnVoucher):hover .color-circle {
      transform: scale(1.1);
    }

    .controls button.active .color-circle {
      border-color: #FFFFFF;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      transform: scale(1.1);
    }

    #btnRed .color-circle {
      background-color: #EA4335;
    }
    #btnBlue .color-circle {
      background-color: #4285F4;
    }
    #btnBlack .color-circle {
      background-color: #000000;
    }

    #btnVoucher {
      background-color: #28a745;
      color: white;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 30px;
      margin-left: 10px;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    
    #btnVoucher:hover {
      background-color: #2ebf4f;
      transform: scale(1.05);
    }

    /* === "Frosted Glass" Pop-up Modal Styles === */
    #modal-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 100;
      display: none; 
      align-items: center;
      justify-content: center;
    }

    #modal-content {
      background: rgba(255, 255, 255, 0.2); 
      backdrop-filter: blur(15px); 
      -webkit-backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.3); 
      color: #FFF; 
      padding: 25px; 
      border-radius: 20px; 
      text-align: center;
      width: 85%; 
      max-width: 350px; 
      position: relative;
      box-shadow: 0 8px 30px rgba(0,0,0,0.4); 
    }

    #modal-content img {
      width: 100%;
      max-width: 280px; 
      border-radius: 8px; 
      margin-bottom: 15px; 
    }

    #modal-content h3 {
      margin-top: 0;
      margin-bottom: 15px; 
      color: #FFF; 
      font-size: 22px; 
      text-shadow: 0 1px 3px rgba(0,0,0,0.2); 
    }
    
    .modal-buttons {
      display: flex;
      justify-content: space-around;
      gap: 10px; 
      margin-top: 20px; 
    }

    .modal-buttons a,
    .modal-buttons button {
      flex: 1; 
      text-decoration: none;
      font-size: 15px; 
      padding: 12px 0; 
      border-radius: 10px; 
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.2); 
    }
    
    .modal-buttons button:hover,
    .modal-buttons a:hover {
      transform: translateY(-2px); 
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }

    #visitBtn {
      background-color: #007bff; 
      color: white;
    }
    #visitBtn:hover {
        background-color: #0056b3;
    }

    #shareBtn {
      background-color: #6c757d; 
      color: white;
    }
    #shareBtn:hover {
        background-color: #5a6268;
    }
    
    #closeBtn {
      position: absolute;
      top: 10px; 
      right: 15px; 
      background: rgba(255, 255, 255, 0.2); 
      border-radius: 50%; 
      width: 30px; 
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px; 
      font-weight: bold;
      cursor: pointer;
      color: #FFF; 
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    #closeBtn:hover {
      background: rgba(255, 255, 255, 0.4);
      transform: rotate(90deg); 
    }
  </style>
</head>

<body>
  <div class="controls">
    <button id="btnRed" class="active">
      <span class="color-circle"></span>
    </button>
    <button id="btnBlue">
      <span class="color-circle"></span>
    </button>
    <button id="btnBlack">
      <span class="color-circle"></span>
    </button>
    <button id="btnVoucher">üéÅ Get Voucher</button>
  </div>

  <div id="modal-overlay">
    <div id="modal-content">
      <button id="closeBtn">&times;</button>
      <h3>You Won!</h3>
      <img src="./voucher.png" alt="20% Off Voucher" />
      <div class="modal-buttons">
        <button id="shareBtn">Share</button>
        <a id="visitBtn" href="https://www.nike.com/my/" target="_blank">Visit Site</a>
      </div>
    </div>
  </div>

  <a-scene mindar-image="imageTargetSrc: ./Target_Complete.mind; autoStart: true; maxTrack: 1;" color-space="sRGB"
    renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false"
    device-orientation-permission-ui="enabled: false">

    <a-assets>
      <a-asset-item id="modelRed" src="./Red_Shoes.glb"></a-asset-item>
      <a-asset-item id="modelBlue" src="./BlueShoes.glb"></a-asset-item>
      <a-asset-item id="modelBlack" src="./Black_Shoes.glb"></a-asset-item>
      <a-asset-item id="voucherImg" src="./voucher.png"></a-asset-item>
    </a-assets>

    <a-light type="ambient" color="#FFF" intensity="0.5"></a-light>
    <a-light type="directional" color="#FFF" intensity="1" position="1 1 1"></a-light>
    
    <a-camera position="0 0 0" look-controls="enabled: false" cursor="rayOrigin: mouse"></a-camera>

    <a-entity mindar-image-target="targetIndex: 0">

      <a-gltf-model id="productModelRed" src="#modelRed" 
        position="0 0.2 0" scale="0.06 0.06 0.06" rotation="0 0 0" 
        visible="true" 
        animation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear">
      </a-gltf-model>
      <a-gltf-model id="productModelBlue" src="#modelBlue" 
        position="0 0.2 0" scale="0.06 0.06 0.06" rotation="0 0 0" 
        visible="false" 
        animation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear">
      </a-gltf-model>
      <a-gltf-model id="productModelBlack" src="#modelBlack" 
        position="0 0.2 0" scale="0.06 0.06 0.06" rotation="0 0 0" 
        visible="false" 
        animation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear">
      </a-gltf-model>

    </a-entity>
  </a-scene>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Get all elements
      const modelRed = document.querySelector('#productModelRed');
      const modelBlue = document.querySelector('#productModelBlue');
      const modelBlack = document.querySelector('#productModelBlack');
      const btnRed = document.querySelector('#btnRed');
      const btnBlue = document.querySelector('#btnBlue');
      const btnBlack = document.querySelector('#btnBlack');
      const allButtons = [btnRed, btnBlue, btnBlack];
      
      const btnVoucher = document.querySelector('#btnVoucher');
      const modalOverlay = document.querySelector('#modal-overlay');
      const closeBtn = document.querySelector('#closeBtn');
      const shareBtn = document.querySelector('#shareBtn');
      
      // --- 1. Color Swap Logic ---
      function setActiveButton(activeButton) {
        allButtons.forEach(button => {
          button.classList.remove('active');
        });
        activeButton.classList.add('active');
      }
      btnRed.addEventListener('click', () => {
        modelRed.setAttribute('visible', 'true');
        modelBlue.setAttribute('visible', 'false');
        modelBlack.setAttribute('visible', 'false');
        setActiveButton(btnRed);
      });
      btnBlue.addEventListener('click', () => {
        modelRed.setAttribute('visible', 'false');
        modelBlue.setAttribute('visible', 'true');
        modelBlack.setAttribute('visible', 'false');
        setActiveButton(btnBlue);
      });
      btnBlack.addEventListener('click', () => {
        // THIS IS THE LINE I FIXED
        modelRed.setAttribute('visible', 'false');
        modelBlue.setAttribute('visible', 'false');
        modelBlack.setAttribute('visible', 'true');
        setActiveButton(btnBlack);
      });
      setActiveButton(btnRed);

      // --- 2. Click-to-Reward Logic ---
      
      // Show the modal when "Get Voucher" is clicked
      btnVoucher.addEventListener('click', () => {
        modalOverlay.style.display = 'flex';
      });

      // Hide the modal when the "Close" button is clicked
      closeBtn.addEventListener('click', () => {
        modalOverlay.style.display = 'none';
      });

      // --- 3. Share Button Logic ---
      shareBtn.addEventListener('click', () => {
        if (navigator.share) {
          navigator.share({
            title: 'Seni Jaya AR Demo',
            text: 'I just got a 20% voucher from this cool AR ad!',
            url: 'https://www.nike.com/my/'
          }).catch(console.error);
        } else {
          // Fallback for desktop or unsupported browsers
          alert('Share feature is not available on your browser. Please copy the link manually.');
        }
      });
      
    });
  </script>
</body>
</html>